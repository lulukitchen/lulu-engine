# Project Structure - @lulu/engine

Comprehensive overview of the Lulu Engine project organization, designed to help developers and AI coding assistants understand the codebase architecture.

## ğŸ“ Root Directory Structure

```
lulu-engine/
â”œâ”€â”€ .github/                 # GitHub-specific files
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ ci.yml          # Continuous Integration pipeline
â”œâ”€â”€ src/                    # Source code (TypeScript/React)
â”‚   â”œâ”€â”€ index.ts           # Main entry point - exports all public APIs
â”‚   â”œâ”€â”€ types.ts           # Central type definitions
â”‚   â”œâ”€â”€ components/        # Reusable React components
â”‚   â”œâ”€â”€ hooks/             # Custom React hooks
â”‚   â”œâ”€â”€ provider/          # React Context providers
â”‚   â”œâ”€â”€ services/          # External API integrations
â”‚   â””â”€â”€ utils/             # Pure utility functions
â”œâ”€â”€ dist/                   # Built output (generated by `npm run build`)
â”‚   â”œâ”€â”€ index.js           # ESM bundle
â”‚   â”œâ”€â”€ index.cjs          # CommonJS bundle
â”‚   â”œâ”€â”€ index.d.ts         # TypeScript declarations (ESM)
â”‚   â””â”€â”€ index.d.cts        # TypeScript declarations (CJS)
â”œâ”€â”€ node_modules/          # Dependencies (ignored in git)
â”œâ”€â”€ .eslintrc.cjs          # ESLint configuration
â”œâ”€â”€ .gitignore             # Git ignore patterns
â”œâ”€â”€ API.md                 # Complete API documentation
â”œâ”€â”€ CONTRIBUTING.md        # Contributor guidelines
â”œâ”€â”€ LICENSE                # MIT License
â”œâ”€â”€ package.json           # Project configuration and dependencies
â”œâ”€â”€ package-lock.json      # Exact dependency versions
â”œâ”€â”€ README.md              # Project overview and quick start
â”œâ”€â”€ TESTING.md             # Testing setup and guidelines
â”œâ”€â”€ tsconfig.json          # TypeScript configuration
â””â”€â”€ lulu-engine-starter.zip # Original starter files archive
```

## ğŸ¯ Source Code Organization

### `/src` Directory Detailed Structure

```
src/
â”œâ”€â”€ index.ts                 # ğŸ“¤ Public API exports
â”œâ”€â”€ types.ts                 # ğŸ·ï¸  TypeScript definitions
â”‚
â”œâ”€â”€ provider/                # ğŸ”— React Context Providers
â”‚   â””â”€â”€ EngineProvider.tsx   #     Main configuration provider
â”‚
â”œâ”€â”€ hooks/                   # ğŸ£ Custom React Hooks
â”‚   â”œâ”€â”€ useCart.ts          #     Shopping cart state management
â”‚   â””â”€â”€ useLanguage.tsx     #     Internationalization (i18n)
â”‚
â”œâ”€â”€ services/                # ğŸŒ External Integrations
â”‚   â”œâ”€â”€ menuService.ts      #     CSV menu fetching/parsing
â”‚   â”œâ”€â”€ emailService.ts     #     Order email notifications
â”‚   â””â”€â”€ whatsappService.ts  #     WhatsApp message formatting
â”‚
â”œâ”€â”€ utils/                   # ğŸ› ï¸  Pure Utility Functions
â”‚   â”œâ”€â”€ businessHours.ts    #     Operating hours logic
â”‚   â”œâ”€â”€ coupons.ts          #     Discount calculations
â”‚   â””â”€â”€ recommendations.ts  #     Product suggestions
â”‚
â””â”€â”€ components/              # âš›ï¸  React UI Components
    â”œâ”€â”€ MenuItemModal.tsx   #     Product details popup
    â”œâ”€â”€ PaymentOptions.tsx  #     Payment method selector
    â”œâ”€â”€ TimePicker.tsx      #     Delivery time picker
    â””â”€â”€ WhatsAppButton.tsx  #     WhatsApp contact button
```

## ğŸ—ï¸ Architecture Layers

### 1. **Export Layer** (`index.ts`)
- Single entry point for all public APIs
- Named exports only (no default exports)
- Clean, documented interface for consumers

### 2. **Type System** (`types.ts`)
- Centralized TypeScript definitions
- Domain models: MenuItem, CartItem, Order, etc.
- Configuration interfaces: EngineConfig, BusinessHours
- Strict typing for all public APIs

### 3. **Provider Layer** (`provider/`)
- React Context for dependency injection
- Configuration management
- Global state initialization

### 4. **Hook Layer** (`hooks/`)
- Stateful logic encapsulation
- React-specific integrations
- localStorage persistence
- Cross-component state sharing

### 5. **Service Layer** (`services/`)
- External system integrations
- Data transformation (CSV parsing, etc.)
- Communication protocols (email, WhatsApp)
- Async operations handling

### 6. **Utility Layer** (`utils/`)
- Pure functions (no side effects)
- Business logic implementations
- Calculations and validations
- Reusable algorithms

### 7. **Component Layer** (`components/`)
- Presentational React components
- Minimal business logic
- Customizable through props
- Accessibility-focused

## ğŸ”„ Data Flow Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CSV Source    â”‚â”€â”€â”€â–¶â”‚  menuService    â”‚â”€â”€â”€â–¶â”‚   MenuItem[]    â”‚
â”‚ (Google Sheets) â”‚    â”‚   (parsing)     â”‚    â”‚     (state)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                        â”‚
                                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Actions   â”‚â”€â”€â”€â–¶â”‚   useCart()     â”‚â”€â”€â”€â–¶â”‚  localStorage   â”‚
â”‚  (add/remove)   â”‚    â”‚    (hook)       â”‚    â”‚ (persistence)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                        â”‚
                                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Order        â”‚â”€â”€â”€â–¶â”‚   Services      â”‚â”€â”€â”€â–¶â”‚   External      â”‚
â”‚ (processed)     â”‚    â”‚ (email/whatsapp)â”‚    â”‚    Systems      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ Build System Architecture

### Input Sources
- TypeScript source files (`src/**/*.ts`, `src/**/*.tsx`)
- Type definitions (`src/types.ts`)
- Configuration files (`tsconfig.json`, `.eslintrc.cjs`)

### Build Pipeline (tsup)
1. **TypeScript Compilation**: Source â†’ JavaScript
2. **Bundle Generation**: 
   - ESM format (`dist/index.js`)
   - CommonJS format (`dist/index.cjs`)
3. **Type Declaration Generation**:
   - ESM types (`dist/index.d.ts`)
   - CommonJS types (`dist/index.d.cts`)

### Output Targets
- **Modern Browsers**: ES2020 syntax support
- **Node.js**: CommonJS compatibility
- **TypeScript Projects**: Full type information

## ğŸ”§ Development Workflow

### File Creation Patterns

#### Adding a New Hook
```bash
# 1. Create the hook file
touch src/hooks/useNewFeature.ts

# 2. Implement the hook
cat > src/hooks/useNewFeature.ts << 'EOF'
import { useState, useEffect } from 'react';

export function useNewFeature() {
  const [state, setState] = useState();
  
  // Hook implementation
  
  return { state, setState };
}
EOF

# 3. Export from index.ts
echo 'export * from "./hooks/useNewFeature";' >> src/index.ts

# 4. Test the build
npm run build
```

#### Adding a New Component
```bash
# 1. Create component file
touch src/components/NewComponent.tsx

# 2. Implement component
cat > src/components/NewComponent.tsx << 'EOF'
import React from 'react';

export const NewComponent: React.FC<{
  prop: string;
}> = ({ prop }) => {
  return <div>{prop}</div>;
};
EOF

# 3. Export and build
echo 'export * from "./components/NewComponent";' >> src/index.ts
npm run build
```

### Quality Assurance Pipeline

1. **Type Checking**: `npm run type-check`
   - Validates TypeScript types
   - Catches type errors early
   - No runtime impact

2. **Linting**: `npm run lint`
   - Code style consistency
   - React hooks rules
   - Best practices enforcement

3. **Building**: `npm run build`
   - Multi-format bundling
   - Type declaration generation
   - Distribution preparation

4. **CI Pipeline**: GitHub Actions
   - Automated quality checks
   - Build verification
   - Deployment readiness

## ğŸ¨ Code Organization Principles

### 1. **Separation of Concerns**
- **Components**: UI presentation only
- **Hooks**: State management and side effects
- **Services**: External system communication
- **Utils**: Pure business logic

### 2. **Dependency Direction**
```
Components â”€â”€â–¶ Hooks â”€â”€â–¶ Services â”€â”€â–¶ Utils
     â”‚                      â”‚
     â””â”€â”€â”€â”€â”€â”€â–¶ Types â—€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. **Import Conventions**
```typescript
// âœ… Good: Specific, named imports
import { useCart, MenuItem } from '@lulu/engine';

// âŒ Bad: Wildcard imports
import * as LuluEngine from '@lulu/engine';
```

### 4. **Export Patterns**
```typescript
// âœ… Good: Named exports
export function calculateTotal(items: CartItem[]): number { ... }
export const PaymentButton: React.FC<Props> = ({ ... }) => { ... };

// âŒ Bad: Default exports
export default function calculateTotal(items: CartItem[]): number { ... }
```

## ğŸ” File Naming Conventions

### TypeScript Files
- **Hooks**: `use[FeatureName].ts` (e.g., `useCart.ts`)
- **Services**: `[domain]Service.ts` (e.g., `menuService.ts`)
- **Utils**: `[domain].ts` (e.g., `businessHours.ts`)
- **Types**: `types.ts` (central) or `[domain].types.ts`

### React Components
- **Component Files**: `[ComponentName].tsx` (PascalCase)
- **Export Name**: Same as filename (e.g., `PaymentOptions.tsx` â†’ `PaymentOptions`)

### Configuration Files
- **ESLint**: `.eslintrc.cjs` (CommonJS for compatibility)
- **TypeScript**: `tsconfig.json` (JSON format)
- **Git**: `.gitignore` (dot prefix)

## ğŸ“š Documentation Structure

### Primary Documentation
1. **README.md**: Project overview, quick start, basic examples
2. **API.md**: Complete API reference with types and examples
3. **CONTRIBUTING.md**: Development setup and contribution guidelines
4. **TESTING.md**: Test strategy and setup instructions

### Code Documentation
- **JSDoc Comments**: For complex functions and classes
- **Inline Comments**: For non-obvious business logic
- **Type Annotations**: Explicit types for all public APIs
- **README Sections**: Usage examples and integration guides

This structure ensures the codebase remains maintainable, discoverable, and easy to extend for both human developers and AI coding assistants.